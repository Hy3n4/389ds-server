---
- include: install_389ds.yaml
  when: false # TODO: remove this (for quick and dirty testing)

- name: Prepare LDAP auth data
  set_fact:
    ldap_auth:
      server_uri: "ldap:///localhost" # TODO: by /// instead of /?
      bind_dn: "{{ rootdn }}"
      bind_pw: "{{ rootdn_password }}"

- include: configure_logging.yaml
  when: false # TODO: remove this (for quick and dirty testing)

- include: configure_plugins.yaml
  when: false # TODO: remove this (for quick and dirty testing)

- include: configure_tls.yaml
  when: security.tls_enabled

- include: configure_security.yaml

- include: configure_replication_replica.yaml
  when: false # roreplica

- include: configure_replication_master.yaml
  when: false # rwmaster

#- include: cleanup.yaml

- include: configure_firewall.yaml
  when: false
